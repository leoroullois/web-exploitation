import * as jwt from "jsonwebtoken";

export const APP_SECRET = process.env.APP_SECRET || "secret";

export interface AuthTokenPayload {
   userId: string;
}

export const decodeAuthHeader = (authHeader: string): AuthTokenPayload => {
   const token = authHeader.replace("Bearer ", "");
   if (!token) {
      throw new Error("No token found");
   }
   const decoded = jwt.verify(token, APP_SECRET);
   return decoded as AuthTokenPayload;
};
